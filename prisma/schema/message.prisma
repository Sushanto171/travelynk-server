model Message {
  id              String   @id @default(uuid())

  conversation_id String
  conversation    Conversation @relation(fields: [conversation_id], references: [id], onDelete: Cascade)

  sender_id       String
  sender          User     @relation(fields: [sender_id], references: [id], onDelete: Cascade)
  type            MessageType @default(TEXT)
  status          MessageStatus @default(SENT)

  content         String?
  created_at      DateTime @default(now())

  @@index([conversation_id])
  @@index([sender_id])
}


model Conversation {
  id         String   @id @default(uuid())

  user_sender_id  String
  user_receiver_id  String

  userA      User     @relation("sender", fields: [user_sender_id], references: [id], onDelete: Cascade)
  userB      User     @relation("receiver", fields: [user_receiver_id], references: [id], onDelete: Cascade)

  isDeleted  Boolean  @default(false)
  created_at DateTime @default(now())

  messages   Message[]

  @@unique([user_sender_id, user_receiver_id])
  @@index([user_sender_id])
  @@index([user_receiver_id])
}
