model Plan {
  id            String        @id @default(uuid())

  owner_id      String
  owner         Traveler     @relation("plan_owner", fields: [owner_id], references: [id])

  title         String
  destination   String       // Human readable (Dhaka, Coxâ€™s Bazar, Bali)
  latitude      Float?       // Example: 23.8103
  longitude     Float?       // Example: 90.4125
  place_id      String?      // Google Places / OSM reference
  map_url       String?      // Shareable Google / OSM map link

  budget        Float?
  start_date    DateTime
  end_date      DateTime

  tour_type     PlanType     @default(SOLO)

  itinerary     String?
  tag           String?

  slug          String       @unique
  status        PlanStatus   @default(PENDING)

  buddies       PlanBuddy[]
  reviews       Review[]

  created_at    DateTime     @default(now())
  updated_at    DateTime     @updatedAt
  
  @@map("plans")
}


model PlanBuddy { 
  traveler_id String
  plan_id     String
  request_type RequestType
  traveler    Traveler  @relation(fields: [traveler_id], references: [id], onDelete: Cascade)
  plan        Plan      @relation(fields: [plan_id], references: [id], onDelete: Cascade)
  created_at       DateTime  @default(now())
  updated_at       DateTime  @updatedAt

  @@id([traveler_id, plan_id])
  @@map("TravelerToPlans")
}

model Review {
  id          String    @id @default(uuid())
  reviewer_id String
  plan_id     String
  rating      Int
  comment     String?
  created_at       DateTime  @default(now())
  updated_at       DateTime  @updatedAt

  reviewer    Traveler  @relation(fields: [reviewer_id], references: [id], onDelete: Cascade)
  plan        Plan      @relation(fields: [plan_id], references: [id], onDelete: Cascade)

  @@unique([reviewer_id, plan_id])
  @@map("reviews")
}
